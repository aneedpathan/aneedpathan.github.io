<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Earn Coins</title>
<style>
body{
  margin:0;
  background:#0b132b;
  color:#fff;
  font-family:Arial;
  text-align:center;
}
.box{
  margin-top:40px;
}
button{
  background:#22c55e;
  border:none;
  padding:15px 25px;
  color:#000;
  font-size:18px;
  border-radius:10px;
  cursor:pointer;
}
</style>
</head>
<body>

<div class="box">
  <h3>User ID</h3>
  <h2 id="uid">---</h2>

  <h3>Total Coins</h3>
  <h1 id="coins">0</h1>

  <button onclick="completeTask()">Complete Task (+10)</button>

  <p style="opacity:.6;margin-top:20px;">Coins are synced online</p>
</div>

<script>
const params = new URLSearchParams(window.location.search);
const uid = params.get("uid");

if(!uid){
  document.body.innerHTML = "<h2>Invalid User</h2>";
}

const API = "https://script.google.com/macros/s/AKfycbw3FaMdic9THdnwO8RZq2M_UU-fkvnUI8IyoK5d-fKLdtQs21ItF7T8WwlRhS2UPBk2ug/exec";

document.getElementById("uid").innerText = uid;

function loadCoins(){
 fetch(API + "?uid=" + uid)
  .then(r=>r.json())
  .then(d=>{
    document.getElementById("coins").innerText = d.coins || 0;
  });
}

let lock = false;

function completeTask(){
 if(lock) return;
 lock = true;

 fetch(API + "?uid=" + uid + "&add=10")
  .then(r=>r.json())
  .then(d=>{
    document.getElementById("coins").innerText = d.coins;
    setTimeout(()=>lock=false,3000);
  });
}

loadCoins();
</script>

</body>
</html>
